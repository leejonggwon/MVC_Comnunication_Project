
-- 커뮤니티프로젝트--


--좋아요--
CREATE TABLE CM_LIKE (
    IDX INT NOT NULL,
    MEMID VARCHAR(20) NOT NULL,
    LIKEAVAILABLE INT DEFAULT 1,
    PRIMARY KEY (IDX, MEMID)
);

--DROP TABLE CM_LIKE;--
--DELETE FROM CM_LIKE;--

SELECT * FROM CM_LIKE;


--커뮤니티 게시판--
CREATE TABLE CM_BOARD(
   IDX INT NOT NULL,
   MEMID VARCHAR(20) NOT NULL,
   TITLE VARCHAR(100) NOT NULL,
   CONTENT VARCHAR(2000) NOT NULL,
   WRITER VARCHAR(30) NOT NULL,
   INDATE DATETIME DEFAULT NOW(),
   COUNT INT DEFAULT 0,
   LIKECOUNT INT DEFAULT 0,  --좋아요수--
   IMGPATH VARCHAR(500), 
   -- 댓글기능 추가 --
   BOARDGROUP INT,     -- 어떤 그룹에 댓글을 달았는지 알수있는 --
   BOARDSEQUENCE INT,  -- 같은 그룹안에서 댓글의 순서를 저장하는 변수 --
   BOARDLEVEL INT,     -- 1단계(원본글댓글) 2단계(댓글에댓글) 인지에 대한 정보 --   
   BOARDAVAILABLE INT, -- 삭제된 글인지 여부 판별한다 --
   PRIMARY KEY(IDX)
);

DROP TABLE CM_BOARD;

SELECT * FROM CM_BOARD;

DELETE FROM CM_BOARD;


-- 회원--
CREATE TABLE CM_MEMBER(
	MEMIDX INT AUTO_INCREMENT,
	MEMID VARCHAR(20) NOT NULL,
	MEMPASSWORD VARCHAR(20) NOT NULL,
	MEMNAME VARCHAR(20) NOT NULL,
	MEMNICKNAME VARCHAR(20) NOT NULL,
	MEMAGE INT,
	MEMGENDER VARCHAR(20),
	MEMEMAIL VARCHAR(50),
	MEMPROFILE VARCHAR(50), 
	MEMSTATUS INT DEFAULT 0, 
	PRIMARY KEY(MEMIDX)
);

DROP TABLE CM_MEMBER;
DELETE FROM CM_MEMBER;

SELECT * FROM CM_MEMBER;


-- 댓글 --
CREATE TABLE CM_COMMENT(
	CMTIDX INT AUTO_INCREMENT,         
	IDX INT NOT NULL,                  
	CMTCONTENT VARCHAR(2000) NOT NULL, 
	MEMID VARCHAR(20) NOT NULL,       
	MEMNAME VARCHAR(30) NOT NULL,     
	MEMNICKNAME VARCHAR(30) NOT NULL,     
	MEMPROFILE VARCHAR(50),            
	CMTINDATE DATETIME DEFAULT NOW(), 
	CMTAVAILABLE INT DEFAULT 1,       
	PRIMARY KEY(CMTIDX)
);

DROP TABLE CM_COMMENT;

SELECT * FROM CM_COMMENT;

DELETE FROM CM_COMMENT;

SELECT * FROM CM_LIKE WHERE IDX = 49;



--좌석--
CREATE TABLE CM_SEAT(
	SEATNUM INT NOT NULL,   
	SEATNAME VARCHAR(20) NOT NULL, 
	SEATAVAILABLE INT DEFAULT 0,   
	PRIMARY KEY(SEATNUM)
);

SELECT * FROM CM_SEAT;
DROP TABLE CM_SEAT;
DELETE FROM CM_SEAT;

INSERT INTO CM_SEAT(SEATNUM, SEATNAME) VALUES
(1, '01번'),
(2, '02번'),
(3, '03번'),
(4, '04번'),
(5, '05번'),
(6, '06번'),
(7, '07번'),
(8, '08번'),
(9, '09번'),
(10, '10번'),







INSERT INTO CM_SEAT(SEATNUM, SEATNAME, SEATAVAILABLE) VALUES
(11, 'no11', 1);



--좌석예약정보--
CREATE TABLE CM_RESERVATION(
	RIDX INT AUTO_INCREMENT,  
	SEATNUM INT NOT NULL, 
	SEATNAME VARCHAR(20) NOT NULL, 
	MEMID VARCHAR(20) NOT NULL, 
	MEMNAME VARCHAR(20) NOT NULL,
	MEMNICKNAME VARCHAR(20) NOT NULL,
	STARTTIME DATETIME DEFAULT NOW(),
	ENDTIME DATETIME DEFAULT NOW(),     
	ENDTIMESTATUS INT DEFAULT 0,   
	PRIMARY KEY(RIDX)
);


SELECT * FROM CM_RESERVATION;


DELETE FROM CM_RESERVATION;
DROP TABLE CM_RESERVATION;


SELECT * FROM CM_RESERVATION WHERE MEMID = "admin" AND ENDTIME IS NULL ORDER BY SEATNUM DESC LIMIT 1

SELECT * FROM CM_RESERVATION WHERE MEMID = "admin";
SELECT * FROM CM_RESERVATION WHERE MEMID = "admin" ORDER BY RIDX DESC LIMIT 1

SELECT * FROM CM_MEMBER;

--리뉴얼 --
INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('admin','1234','스프링관리자', '스프링관리자', 38, '남자', 'admin@gmail.com');


INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('samsung','1234','이재용', '9만전자가즈아', 20, '남자', 'samsung@gmail.com');

INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('apple','1234','Jobs', '스마트폰은 아이폰', 20, '남자', 'apple@gmail.com');

INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('NVIDIA','1234','Jensen Huang', 'GPU를 선물로 줄꼐요', 20, '남자', 'NVIDIA@gmail.com');

INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('JAVA','1234','James Gosling', '나는야 자바의아버지', 20, '남자', 'JAVA@gmail.com');

INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('spring','1234','Rod Johnson', '스프링의창시자', 20, '남자', 'spring@gmail.com');

INSERT INTO CM_MEMBER (MEMID, MEMPASSWORD, MEMNAME, MEMNICKNAME, MEMAGE, MEMGENDER, MEMEMAIL)
VALUES ('korea','1234','서울이', '케이팝데몬헌터스', 20, '남자', 'korea@gmail.com');


DELETE FROM CM_MEMBER;

SELECT * FROM CM_MEMBER;


DELETE FROM CM_BOARD WHERE IDX = 151;


INSERT INTO CM_BOARD
SELECT IFNULL(MAX(IDX)+1,1), 'admin', '학부모 상담 주간 안내', '다음 주 월요일부터 금요일까지 학부모 상담 주간이 진행됩니다.', '스프링관리자', NOW(),0,0, null, IFNULL(MAX(BOARDGROUP)+1,1), 0, 0, 1
FROM CM_BOARD;




INSERT INTO CM_BOARD 
SELECT IFNULL(MAX(IDX)+1,1),
       '스프링관리자', 
       '공지사항 1: 새로운 기능과 서비스 개선 안내', 
       '1번 공지사항: 이번 업데이트로 새로운 기능이 추가되고 기존 서비스가 개선되었습니다. 자세한 내용은 공지사항 페이지를 참고해주세요.', 
       '스프링관리자', 
       NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 
FROM CM_BOARD;

INSERT INTO CM_BOARD 
SELECT IFNULL(MAX(IDX)+1,1),
       '스프링관리자', 
       '알림 2: 서버 점검 및 사용자 안내', 
       '2번 알림: 예정된 서버 점검 일정과 이용자 주의 사항을 안내드립니다. 점검 시간 동안 서비스 이용에 제한이 있을 수 있습니다.', 
       '스프링관리자', 
       NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 
FROM CM_BOARD;





INSERT INTO CM_BOARD SELECT IFNULL(MAX(IDX)+1,1),'admin','공지사항 1','1번 공지사항 안내드립니다','스프링관리자',NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 FROM CM_BOARD;
INSERT INTO CM_BOARD SELECT IFNULL(MAX(IDX)+1,1),'admin','알림 2','2번 알림 전달드립니다','스프링관리자',NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 FROM CM_BOARD;
INSERT INTO CM_BOARD SELECT IFNULL(MAX(IDX)+1,1),'admin','행사 안내 3','3번 행사 일정 안내입니다','스프링관리자',NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 FROM CM_BOARD;
INSERT INTO CM_BOARD SELECT IFNULL(MAX(IDX)+1,1),'admin','업데이트 4','4번 시스템 업데이트 내용 안내','스프링관리자',NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 FROM CM_BOARD;
INSERT INTO CM_BOARD SELECT IFNULL(MAX(IDX)+1,1),'admin','공지 5','5번 공지 관련 안내','스프링관리자',NOW(),0,0,NULL,IFNULL(MAX(BOARDGROUP)+1,1),0,0,1 FROM CM_BOARD;








